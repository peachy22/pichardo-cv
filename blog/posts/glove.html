<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Another Post | John Doe</title>
  <link rel="stylesheet" href="/style.css">
</head>


  <header>
    <nav><a href="../index.html">← Back to Blog</a></nav>
    <h1>Python: Customer Sentiment Analysis ''Like a GloVe''</h1>
    <p><em>October 5, 2025 • by Stephan Pichardo</em></p>
  </header>

  <body>
<p>&nbsp;</p><div class="separator" style="clear: both; text-align: center;"><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto;"><tbody><tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEgR2LiC-ygmsDRP9A-d98NX_VXEAUljloZAhhnHJdaevSMItBf-kmhl4Cj7gnLJNi_LNkB2rH6hjxrzKjH_InDc-_B3dZxAdl7PO8KCwYhkpCkywImuGOAHiAY89uaY634EF1HITSAReSmozy5MbaUJZdLNrmY2snu9IGdcz_uEKfB33-huXRVPsoJX" style="margin-left: auto; margin-right: auto;"><img alt="" data-original-height="446" data-original-width="679" height="420" src="https://blogger.googleusercontent.com/img/a/AVvXsEgR2LiC-ygmsDRP9A-d98NX_VXEAUljloZAhhnHJdaevSMItBf-kmhl4Cj7gnLJNi_LNkB2rH6hjxrzKjH_InDc-_B3dZxAdl7PO8KCwYhkpCkywImuGOAHiAY89uaY634EF1HITSAReSmozy5MbaUJZdLNrmY2snu9IGdcz_uEKfB33-huXRVPsoJX=w640-h420" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><i style="color: #999999;">"great game nice graphics" - nuanced and thought-provoking critic</i></td></tr></tbody></table></div><h2 style="text-align: left;">Context</h2><p style="text-align: left;"><span style="font-family: inherit;">In this article, I'm going to walk through the process of using Python and the Tensorflow framework (via the Keras module) to sort user reviews of video games and gaming products into positive or negative categories based on the language included in each review. These are common tools and methods of Natural Language Processing (NLP) and sentiment analysis.<span style="font-family: inherit;">&nbsp;</span></span><span color="rgba(0, 0, 0, 0.87)" style="background-color: white; caret-color: rgba(0, 0, 0, 0.87);"><span style="font-family: inherit;">Text-based problems are understood to be well-approached by recurrent neural networks (RNN) due to their internal memory, which allows them to model sequential data. This type of model is being used in many modern applications such as Google Translate. Long Short-Term Memory (LSTM) modeling will be used in this report- this is an extension of RNN that enables the use of input memorized over a long range, such as with the context of text paragraphs.&nbsp;</span></span><span style="background-color: white; caret-color: rgb(32, 33, 36); color: #202124; font-size: 16px;">¹&nbsp;</span></p><p style="text-align: left;"><span style="background-color: white; caret-color: rgb(32, 33, 36); color: #202124; font-size: 16px;">Along the way, it will be necessary to employ a method of <i>word embedding</i>- the system by which words are given a numeric representation and their similarity quantified. For this I am using GloVe, or Global Vectors for Word Representation. This is a fantastic project from Stanford University that derives quantifiable relationships between English words based on the statistics of their co-occurence</span><span face="arial, sans-serif" style="background-color: white; caret-color: rgb(32, 33, 36); color: #202124; font-size: 16px;">². </span><span style="background-color: white; caret-color: rgb(32, 33, 36); color: #202124; font-size: 16px;"><span style="font-family: inherit;">More on this implementation in the corresponding section!</span></span></p><p style="text-align: left;"><span color="rgba(0, 0, 0, 0.87)" style="background-color: white; caret-color: rgba(0, 0, 0, 0.87);">I'm now going to display the modules that are utilized for this purpose as well as all the supporting processing and visualization tasks.</span></p><p style="text-align: left;"><span color="rgba(0, 0, 0, 0.87)" style="background-color: white; caret-color: rgba(0, 0, 0, 0.87);"></span></p><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white;"><pre><span style="color: grey;">#pandas for dataframe management</span>
<span style="color: #000084; font-weight: bold;">import</span> pandas <span style="color: #000084; font-weight: bold;">as</span> pd
<span style="color: grey;">#additional manipulation</span>
<span style="color: #000084; font-weight: bold;">import</span> numpy <span style="color: #000084; font-weight: bold;">as</span> np
<span style="color: #000084; font-weight: bold;">from</span> numpy <span style="color: #000084; font-weight: bold;">import</span> zeros
<span style="color: #000084; font-weight: bold;">from</span> numpy <span style="color: #000084; font-weight: bold;">import</span> array
<span style="color: #000084; font-weight: bold;">from</span> numpy <span style="color: #000084; font-weight: bold;">import</span> asarray
<span style="color: grey;">#basic statistics</span>
<span style="color: #000084; font-weight: bold;">from</span> statistics <span style="color: #000084; font-weight: bold;">import</span> median, mean
<span style="color: grey;">#regex for strings</span>
<span style="color: #000084; font-weight: bold;">import</span> re
<span style="color: grey;">#plotting and wordclouds</span>
<span style="color: #000084; font-weight: bold;">import</span> seaborn <span style="color: #000084; font-weight: bold;">as</span> sns
<span style="color: #000084; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #000084; font-weight: bold;">as</span> plt
<span style="color: #000084; font-weight: bold;">from</span> wordcloud <span style="color: #000084; font-weight: bold;">import</span> WordCloud, STOPWORDS, ImageColorGenerator
<span style="color: #000084; font-weight: bold;">from</span> PIL <span style="color: #000084; font-weight: bold;">import</span> Image
<span style="color: grey;">#keras tokenizer and modeling</span>
<span style="color: #000084; font-weight: bold;">from</span> keras.preprocessing.text <span style="color: #000084; font-weight: bold;">import</span> Tokenizer
<span style="color: #000084; font-weight: bold;">from</span> keras.models <span style="color: #000084; font-weight: bold;">import</span> Sequential
<span style="color: #000084; font-weight: bold;">from</span> keras.layers.core <span style="color: #000084; font-weight: bold;">import</span> Activation, Dropout, Dense
<span style="color: #000084; font-weight: bold;">from</span> keras.layers <span style="color: #000084; font-weight: bold;">import</span> Flatten
<span style="color: #000084; font-weight: bold;">from</span> tensorflow.keras.layers <span style="color: #000084; font-weight: bold;">import</span> Embedding, LSTM
<span style="color: #000084; font-weight: bold;">from</span> keras.callbacks <span style="color: #000084; font-weight: bold;">import</span> EarlyStopping
<span style="color: grey;">#keras string padding</span>
<span style="color: #000084; font-weight: bold;">from</span> keras_preprocessing.sequence <span style="color: #000084; font-weight: bold;">import</span> pad_sequences
<span style="color: grey;">#training and testing </span>
<span style="color: #000084; font-weight: bold;">from</span> sklearn.model_selection <span style="color: #000084; font-weight: bold;">import</span> train_test_split
<span style="color: grey;">#model metrics</span>
<span style="color: #000084; font-weight: bold;">from</span> sklearn <span style="color: #000084; font-weight: bold;">import</span> metrics</pre></pre></div></pre>
<span><!--Created using ToHtml.com on 2022-11-15 15:54:34 UTC-->

</span><h2 style="text-align: left;"><span style="background-color: white; caret-color: rgba(0, 0, 0, 0.87); font-family: inherit;">Data Retrieval</span></h2><p style="text-align: left;"><span style="font-family: inherit;">The dataset for this tutorial comes from Jianmo Ni's collection of Amazon product reviews</span><span face="arial, sans-serif" style="background-color: white; caret-color: rgb(32, 33, 36); color: #202124; font-size: 16px;">³.</span><span face="arial, sans-serif" style="background-color: white; caret-color: rgb(32, 33, 36); color: #202124; font-size: 16px;">&nbsp;It comes in the .json format, which we will convert to a pandas dataframe before previewing.&nbsp;</span></p><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white;"><span style="color: grey;">#read json file into pandas dataframe</span>
df = pd.read_json(<span style="color: blue;">"/Volumes/EXT128/WGU/Advanced Analytics/nlp/Video_Games_5.json"</span>,lines=True)
<span style="color: grey;">#investigate head</span>
df.head()</pre></div></pre><p style="text-align: left;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEip5poxjUbRq0-ZxPUmS6eaQ4GYCsro6DIkTiNd9pE3KBYEA6SyCnuEhMIGNMlJlhpxZGqMw5f79ZuK2jZ4dDscdrELcgPC1k1Og5Of0iqAcEXP_2zpYRm6iGAvuDQUTJs4eoBDzn0iu6v0RPBOuiQV0uWqW5JPLGWgh2ahvDCnevEcovHgEVaSAN95/s979/Screen%20Shot%202022-11-15%20at%2011.22.43%20AM.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="282" data-original-width="979" height="184" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEip5poxjUbRq0-ZxPUmS6eaQ4GYCsro6DIkTiNd9pE3KBYEA6SyCnuEhMIGNMlJlhpxZGqMw5f79ZuK2jZ4dDscdrELcgPC1k1Og5Of0iqAcEXP_2zpYRm6iGAvuDQUTJs4eoBDzn0iu6v0RPBOuiQV0uWqW5JPLGWgh2ahvDCnevEcovHgEVaSAN95/w640-h184/Screen%20Shot%202022-11-15%20at%2011.22.43%20AM.png" width="640" /></a></div><br /><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white;"><pre><span style="color: grey;">#report dimensions</span>
dims = df.shape
<span style="color: #000084; font-weight: bold;">print</span>(<span style="color: blue;">'The dimensions of the original review set are'</span>,dims,<span style="color: blue;">'.'</span>)</pre></pre></div></pre><span class="mjx-chtml MathJax_CHTML" color="rgba(0, 0, 0, 0.87)" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" id="MathJax-Element-5-Frame" role="presentation" style="border: 0px; box-sizing: unset; caret-color: rgba(0, 0, 0, 0.87); direction: ltr; display: inline-block; float: none; font-family: courier; font-size: 16.66px; line-height: 0; margin: 0px; max-height: none; max-width: none; min-height: 0px; min-width: 0px; overflow-wrap: normal; padding: 1px 0px; position: relative; print-color-adjust: exact; white-space: nowrap;" tabindex="0"><span style="font-size: 14px; white-space: pre-wrap;">The dimensions of the original review set are (497577, 12) .</span></span></span><p style="text-align: left;"><span style="font-family: inherit;">Well there you have it! this dataframe gives us an idea of the extent of the original data and its character. There are almost 500,000 reviews along with miscellaneous metadata, as well as an attempt by Amazon to summarize the review using key words or a star rating.&nbsp;</span></p><h2 style="text-align: left;"><span style="font-family: inherit;">Data Processing and Exploration</span></h2><p style="text-align: left;"><span style="font-family: inherit;">There are a number of things to accomplish before we can begin modeling. The first thing I notice about the original data is that there are more variables than we need- for this project, I only care about the review text and the star rating, which are under the column names </span><span style="font-family: courier;">reviewText&nbsp;</span><span style="font-family: inherit;">and </span><span style="font-family: courier;">overall</span><span style="font-family: inherit;">&nbsp;respectively. The first task in the cleaning process will be to remove the columns that aren't of interest.</span></p><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white;"><pre><span style="color: grey;">#remove undesired columns</span>
df.drop(columns=[<span style="color: blue;">'verified'</span>,<span style="color: blue;">'reviewTime'</span>,<span style="color: blue;">'reviewerID'</span>,<span style="color: blue;">'asin'</span>,<span style="color: blue;">'reviewerName'</span>,<span style="color: blue;">'summary'</span>,<span style="color: blue;">'unixReviewTime'</span>,<span style="color: blue;">'vote'</span>,<span style="color: blue;">'style'</span>,<span style="color: blue;">'image'</span>],inplace=True)</pre></pre></div></pre><p><span style="font-family: inherit;"><span class="mjx-chtml MathJax_CHTML" color="rgba(0, 0, 0, 0.87)" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" face="-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;" id="MathJax-Element-5-Frame" role="presentation" style="border: 0px; box-sizing: unset; caret-color: rgba(0, 0, 0, 0.87); direction: ltr; display: inline-block; float: none; font-size: 16.66px; line-height: 0; margin: 0px; max-height: none; max-width: none; min-height: 0px; min-width: 0px; overflow-wrap: normal; padding: 1px 0px; position: relative; print-color-adjust: exact; white-space: nowrap;" tabindex="0"></span></span><span style="font-family: inherit;">Now it's time to make the kinds of decisions analysts must- remember that in a business situation, the needs of the stakeholders must be carefully understood before taking these steps. It has been established that this is a binary classification problem, and it seems prudent to consider 4 or 5 stars as positive sentiment and 1 or 2 stars as negative. That leaves us with the 3-star reviews- are they positive or negative? Any decision seems completely subjective. In my opinion, the presence of 3-star reviews adds noise to the model so the decision for this project will be to remove those observations. &nbsp;Once that's done, I'm going to assign a value of 0 to the negative reviews and 1 to the positive ones.&nbsp;</span></p><h2 style="text-align: left;"><span style="font-family: inherit;"><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#remove 3-star reviews</span>
df = df[df[<span style="color: blue;">'overall'</span>] != 3]
<span style="color: grey;">#assign binary outcome</span>
df[<span style="color: blue;">'overall'</span>] = np.where(df[<span style="color: blue;">'overall'</span>] &gt; 3, 1, 0)
<span style="color: grey;">#reset indexes for skips introduced by removing rows</span>
df = df.reset_index()
df.drop(columns=[<span style="color: blue;">'index'</span>],inplace=True)</pre></pre></div></pre><span class="mjx-chtml MathJax_CHTML" color="rgba(0, 0, 0, 0.87)" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" face="-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;" id="MathJax-Element-5-Frame" role="presentation" style="border: 0px; box-sizing: unset; caret-color: rgba(0, 0, 0, 0.87); direction: ltr; display: inline-block; float: none; line-height: 0; margin: 0px; max-height: none; max-width: none; min-height: 0px; min-width: 0px; overflow-wrap: normal; padding: 1px 0px; position: relative; print-color-adjust: exact; white-space: nowrap;" tabindex="0"></span></span><div style="text-align: left;"><span style="font-size: small;"><span style="font-family: inherit; font-weight: normal;">The next step also involves some decision making. Some degree of preprocessing is always required with NLP tasks, even in the presence of tokenizers like Keras and embedding methods like GloVe, which are both equipped to some degree for handling raw text. Removing punctuation and numbers is pretty standard, along with making the text lowercase. <i>Where I have seen differing opinions is the removal of stopwords, when the embedding process is typically equipped to handle them by assigning them appropriate weights</i></span><span style="background-color: white; caret-color: rgb(33, 37, 41); color: #212529; font-weight: normal;">⁴</span><i style="font-family: inherit; font-weight: normal;">. </i><span style="font-family: inherit; font-weight: normal;">As usual we have to make a decision, and the one I am going with here is to remove them as part of the cleaning procedure. I believe this to be a step that reduces noise in the model, reduces computational expense in the training process, and allows for the display of more meaningful patterns in visualizations like the wordcloud. We'll instantiate a list of stopwords to filter for and also definine a function to perform the basic preprocessing steps.</span></span></div></h2><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white;"><pre><span style="font-size: x-small;"><span style="color: grey;">#define list of stopwords</span>
stopwords = [ <span style="color: blue;">"a"</span>, <span style="color: blue;">"about"</span>, <span style="color: blue;">"above"</span>, <span style="color: blue;">"after"</span>, <span style="color: blue;">"again"</span>, <span style="color: blue;">"against"</span>, <span style="color: blue;">"all"</span>, <span style="color: blue;">"am"</span>, <span style="color: blue;">"an"</span>, <span style="color: blue;">"and"</span>, <span style="color: blue;">"any"</span>, <span style="color: blue;">"are"</span>, <span style="color: blue;">"as"</span>, <span style="color: blue;">"at"</span>, <span style="color: blue;">"be"</span>, <span style="color: blue;">"because"</span>, 
             <span style="color: blue;">"been"</span>, <span style="color: blue;">"before"</span>, <span style="color: blue;">"being"</span>, <span style="color: blue;">"below"</span>, <span style="color: blue;">"between"</span>, <span style="color: blue;">"both"</span>, <span style="color: blue;">"but"</span>, <span style="color: blue;">"by"</span>, <span style="color: blue;">"could"</span>, <span style="color: blue;">"did"</span>, <span style="color: blue;">"do"</span>, <span style="color: blue;">"does"</span>, <span style="color: blue;">"doing"</span>, <span style="color: blue;">"down"</span>, <span style="color: blue;">"during"</span>,
             <span style="color: blue;">"each"</span>, <span style="color: blue;">"few"</span>, <span style="color: blue;">"for"</span>, <span style="color: blue;">"from"</span>, <span style="color: blue;">"further"</span>, <span style="color: blue;">"had"</span>, <span style="color: blue;">"has"</span>, <span style="color: blue;">"have"</span>, <span style="color: blue;">"having"</span>, <span style="color: blue;">"he"</span>, <span style="color: blue;">"he'd"</span>, <span style="color: blue;">"he'll"</span>, <span style="color: blue;">"he's"</span>, <span style="color: blue;">"her"</span>, <span style="color: blue;">"here"</span>, 
             <span style="color: blue;">"here's"</span>, <span style="color: blue;">"hers"</span>, <span style="color: blue;">"herself"</span>, <span style="color: blue;">"him"</span>, <span style="color: blue;">"himself"</span>, <span style="color: blue;">"his"</span>, <span style="color: blue;">"how"</span>, <span style="color: blue;">"how's"</span>, <span style="color: blue;">"i"</span>, <span style="color: blue;">"i'd"</span>, <span style="color: blue;">"i'll"</span>, <span style="color: blue;">"i'm"</span>, <span style="color: blue;">"i've"</span>, <span style="color: blue;">"if"</span>, <span style="color: blue;">"in"</span>, <span style="color: blue;">"into"</span>,
             <span style="color: blue;">"is"</span>, <span style="color: blue;">"it"</span>, <span style="color: blue;">"it's"</span>, <span style="color: blue;">"its"</span>, <span style="color: blue;">"itself"</span>, <span style="color: blue;">"let's"</span>, <span style="color: blue;">"me"</span>, <span style="color: blue;">"more"</span>, <span style="color: blue;">"most"</span>, <span style="color: blue;">"my"</span>, <span style="color: blue;">"myself"</span>, <span style="color: blue;">"nor"</span>, <span style="color: blue;">"of"</span>, <span style="color: blue;">"on"</span>, <span style="color: blue;">"once"</span>, <span style="color: blue;">"only"</span>, <span style="color: blue;">"or"</span>,
             <span style="color: blue;">"other"</span>, <span style="color: blue;">"ought"</span>, <span style="color: blue;">"our"</span>, <span style="color: blue;">"ours"</span>, <span style="color: blue;">"ourselves"</span>, <span style="color: blue;">"out"</span>, <span style="color: blue;">"over"</span>, <span style="color: blue;">"own"</span>, <span style="color: blue;">"same"</span>, <span style="color: blue;">"she"</span>, <span style="color: blue;">"she'd"</span>, <span style="color: blue;">"she'll"</span>, <span style="color: blue;">"she's"</span>, <span style="color: blue;">"should"</span>, 
             <span style="color: blue;">"so"</span>, <span style="color: blue;">"some"</span>, <span style="color: blue;">"such"</span>, <span style="color: blue;">"than"</span>, <span style="color: blue;">"that"</span>, <span style="color: blue;">"that's"</span>, <span style="color: blue;">"the"</span>, <span style="color: blue;">"their"</span>, <span style="color: blue;">"theirs"</span>, <span style="color: blue;">"them"</span>, <span style="color: blue;">"themselves"</span>, <span style="color: blue;">"then"</span>, <span style="color: blue;">"there"</span>, <span style="color: blue;">"there's"</span>,
             <span style="color: blue;">"these"</span>, <span style="color: blue;">"they"</span>, <span style="color: blue;">"they'd"</span>, <span style="color: blue;">"they'll"</span>, <span style="color: blue;">"they're"</span>, <span style="color: blue;">"they've"</span>, <span style="color: blue;">"this"</span>, <span style="color: blue;">"those"</span>, <span style="color: blue;">"through"</span>, <span style="color: blue;">"to"</span>, <span style="color: blue;">"too"</span>, <span style="color: blue;">"under"</span>, <span style="color: blue;">"until"</span>, <span style="color: blue;">"up"</span>,
             <span style="color: blue;">"very"</span>, <span style="color: blue;">"was"</span>, <span style="color: blue;">"we"</span>, <span style="color: blue;">"we'd"</span>, <span style="color: blue;">"we'll"</span>, <span style="color: blue;">"we're"</span>, <span style="color: blue;">"we've"</span>, <span style="color: blue;">"were"</span>, <span style="color: blue;">"what"</span>, <span style="color: blue;">"what's"</span>, <span style="color: blue;">"when"</span>, <span style="color: blue;">"when's"</span>, <span style="color: blue;">"where"</span>, <span style="color: blue;">"where's"</span>,
             <span style="color: blue;">"which"</span>, <span style="color: blue;">"while"</span>, <span style="color: blue;">"who"</span>, <span style="color: blue;">"who's"</span>, <span style="color: blue;">"whom"</span>, <span style="color: blue;">"why"</span>, <span style="color: blue;">"why's"</span>, <span style="color: blue;">"with"</span>, <span style="color: blue;">"would"</span>, <span style="color: blue;">"you"</span>, <span style="color: blue;">"you'd"</span>, <span style="color: blue;">"you'll"</span>, <span style="color: blue;">"you're"</span>, <span style="color: blue;">"you've"</span>,
             <span style="color: blue;">"your"</span>, <span style="color: blue;">"yours"</span>, <span style="color: blue;">"yourself"</span>, <span style="color: blue;">"yourselves"</span>]
<span style="color: grey;">#define standardizer function</span>
<span style="color: #000084; font-weight: bold;">def</span> standardize(text):
    <span style="color: grey;">#make text lowercase</span>
    txt = text.lower()
    <span style="color: grey;">#remove stopwords</span>
    txt = <span style="color: blue;">' '</span>.join([word <span style="color: #000084; font-weight: bold;">for</span> word <span style="color: #000084; font-weight: bold;">in</span> txt.split() <span style="color: #000084; font-weight: bold;">if</span> word <span style="color: #000084; font-weight: bold;">not</span> <span style="color: #000084; font-weight: bold;">in</span> stopwords])
    <span style="color: grey;">#remove punctuation and numbers</span>
    txt = re.sub(<span style="color: blue;">'[^a-z]'</span>, <span style="color: blue;">' '</span>, txt)
    <span style="color: grey;">#remove single characters</span>
    txt = re.sub(<span style="color: blue;">r'(?:^| )\w(?:$| )'</span>, <span style="color: blue;">' '</span>, txt)
    <span style="color: grey;">#collapse multiple spaces</span>
    txt = re.sub(<span style="color: blue;">r'\s+'</span>, <span style="color: blue;">' '</span>, txt)
    <span style="color: #000084; font-weight: bold;">return</span> txt
<span style="color: grey;">#cast reviews as string</span>
df[<span style="color: blue;">'reviewText'</span>] = df[<span style="color: blue;">'reviewText'</span>].astype(<span style="color: #000084; font-weight: bold;">str</span>)
<span style="color: grey;">#list for review storage</span>
lst = []
<span style="color: grey;">#standardize each review </span>
<span style="color: #000084; font-weight: bold;">for</span> review <span style="color: #000084; font-weight: bold;">in</span> df[<span style="color: blue;">'reviewText'</span>]:
    lst.append(standardize(review))
<span style="color: grey;">#place list into dataframe</span>
df[<span style="color: blue;">'reviewText'</span>] = lst
<span style="color: grey;">#allow display of full text</span>
pd.options.display.max_colwidth = 5000
<span style="color: grey;">#review processed df contents</span>
df.head(5)</span></pre></pre></div></pre><h2 style="text-align: left;"><div style="text-align: left;"><span style="font-size: small;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPp9h8RBtBbUj45VyHXA9Nj4N5WqMB9zuNoYibYrfh-5DuiXZoe83MbvH1wA6yRfvKsOoEcS-JdGh7b4LGIVzl4yZb1RUaTQwoGAvocaGmtmTb5dRXUqH17OBspGGTXHLfA7NscmhYmjLMWv7iosbMdSk79GxLiydoFDVKRgmrnE9jR3xwLxijrFoj/s909/Screen%20Shot%202022-11-15%20at%2012.31.06%20PM.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="160" data-original-width="909" height="112" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPp9h8RBtBbUj45VyHXA9Nj4N5WqMB9zuNoYibYrfh-5DuiXZoe83MbvH1wA6yRfvKsOoEcS-JdGh7b4LGIVzl4yZb1RUaTQwoGAvocaGmtmTb5dRXUqH17OBspGGTXHLfA7NscmhYmjLMWv7iosbMdSk79GxLiydoFDVKRgmrnE9jR3xwLxijrFoj/w640-h112/Screen%20Shot%202022-11-15%20at%2012.31.06%20PM.png" width="640" /></a></div><span style="font-weight: normal;"><br /></span></span></div><div style="text-align: left;"><span style="font-size: small;"><span style="font-weight: normal;">Alright! That's much cleaner than before. The reviews have lost their syntactical structure but retained the key words a machine learning algorithm would be interested in. The ones that are positive, as well as the single visible negative review, make sense with respect to the words they feature. Let's generate the image featured for this article, which is the wordcloud representing the positive review keywords. For comparison, I'm also going to generate the negative version.&nbsp;</span></span></div><div style="text-align: left;"><span style="font-size: small;"><span style="font-weight: normal;"><br /></span></span></div><span style="font-family: inherit;"><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><span style="color: grey;">#import image for styling</span>
mask = np.array(Image.<span style="color: #000084; font-weight: bold;">open</span>(<span style="color: blue;">'/Volumes/EXT128/WGU/Advanced Analytics/nlp/Vector-Game-Controller-PNG-Clipart.png'</span>))
<span style="color: grey;">#generate positive wordcloud</span>
pos = WordCloud(background_color =<span style="color: blue;">'white'</span>,mask=mask,colormap=<span style="color: blue;">'crest'</span>).generate(<span style="color: blue;">" "</span>.join(i <span style="color: #000084; font-weight: bold;">for</span> i <span style="color: #000084; font-weight: bold;">in</span> df.reviewText[df.overall==1]))
<span style="color: grey;">#show</span>
plt.imshow(pos)
plt.axis(<span style="color: blue;">"off"</span>)
plt.show()</pre></div></pre><span class="mjx-chtml MathJax_CHTML" color="rgba(0, 0, 0, 0.87)" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" face="-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;" id="MathJax-Element-5-Frame" role="presentation" style="border: 0px; box-sizing: unset; caret-color: rgba(0, 0, 0, 0.87); direction: ltr; display: inline-block; float: none; font-size: 16.66px; line-height: 0; margin: 0px; max-height: none; max-width: none; min-height: 0px; min-width: 0px; overflow-wrap: normal; padding: 1px 0px; position: relative; print-color-adjust: exact; white-space: nowrap;" tabindex="0"></span></span></h2><h2 style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi6g8ogAluddI8wqNBvGhq_gqvC_XFBDkd3VqcNmwAQg5p7AEmFgZbVa8SH1v2keCcYf58X3AzNbWvfUMluGWZQhv5Y17J_G8_mQ0uJ7LIbYKMTqJhXRJXIga93pzktdtarTIpSH5CS-CrndJsGY1tSC77X4gMj_DouivBTOacYR6iPYd2SYy56XQk9/s515/cont_.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="326" data-original-width="515" height="406" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi6g8ogAluddI8wqNBvGhq_gqvC_XFBDkd3VqcNmwAQg5p7AEmFgZbVa8SH1v2keCcYf58X3AzNbWvfUMluGWZQhv5Y17J_G8_mQ0uJ7LIbYKMTqJhXRJXIga93pzktdtarTIpSH5CS-CrndJsGY1tSC77X4gMj_DouivBTOacYR6iPYd2SYy56XQk9/w640-h406/cont_.png" width="640" /></a></div></h2><h2><span style="font-family: inherit;"><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#generate negative wordcloud</span>
neg = WordCloud(background_color =<span style="color: blue;">'white'</span>,mask=mask,colormap=<span style="color: blue;">'rocket'</span>).generate(<span style="color: blue;">" "</span>.join(i <span style="color: #000084; font-weight: bold;">for</span> i <span style="color: #000084; font-weight: bold;">in</span> df.reviewText[df.overall==0]))
<span style="color: grey;">#show</span>
plt.imshow(neg)
plt.axis(<span style="color: blue;">"off"</span>)
plt.show()</pre></pre></div></pre><span class="mjx-chtml MathJax_CHTML" color="rgba(0, 0, 0, 0.87)" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" face="-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;" id="MathJax-Element-5-Frame" role="presentation" style="border: 0px; box-sizing: unset; caret-color: rgba(0, 0, 0, 0.87); direction: ltr; display: inline-block; float: none; font-size: 16.66px; line-height: 0; margin: 0px; max-height: none; max-width: none; min-height: 0px; min-width: 0px; overflow-wrap: normal; padding: 1px 0px; position: relative; print-color-adjust: exact; white-space: nowrap;" tabindex="0"></span></span></h2><h2><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi7E0_aFwkHGQEL-j3xystMOmGGeQnIrdI7rBdFYY1h1NQ6uSyns4Ksi5rfTQZnHKpQW2sUiEiDojwqvnM2tHBb781IdL7pO3sba8glXNLJ1TuWOJ4B99o0qYmEMhv4Mj_eB8wPuUTxs-peftyyE_PoRN9Zo6sbfPfWOgvd-w9CnrvtU8wvcghZ1lLl/s515/Unknown.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="326" data-original-width="515" height="406" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi7E0_aFwkHGQEL-j3xystMOmGGeQnIrdI7rBdFYY1h1NQ6uSyns4Ksi5rfTQZnHKpQW2sUiEiDojwqvnM2tHBb781IdL7pO3sba8glXNLJ1TuWOJ4B99o0qYmEMhv4Mj_eB8wPuUTxs-peftyyE_PoRN9Zo6sbfPfWOgvd-w9CnrvtU8wvcghZ1lLl/w640-h406/Unknown.png" width="640" /></a></div><p style="text-align: left;"><span style="font-family: inherit; font-size: small; font-weight: normal;">Note that by default the wordcloud module uses colocation- especially in the positive version, you're seeing combinations that you'd expect such as 'great game' and 'video game' rather than a giant 'game' dominating the cloud. This is nice, since from the head call I'd imagine the word 'game' appears in just about all the reviews. That said, the positive cloud is about what I would expect but the negative one is not as loaded with typical language as I thought it would. If you look carefully, there are words like 'bad' but also words like 'good'- the language of the negative reviews is overall more nuanced than I expected and the benefit of LSTM is that it can often pick up on those nuances. A side note from the perspective of someone who has played video games for much of his life: it's interesting to see words like 'still' so visible- it reminds me of common complaints against major game franchises that release similar content year after year.&nbsp;</span></p><p style="text-align: left;"><span style="font-family: inherit; font-size: small; font-weight: normal;">It's now time to start processing the text in ways specific to the embedding and modeling process. First, embedding. Text doesn't mean anything to computers, so we express the textual data we have in a numeric form- a vector, specifically. When we eventually assign numbers to words, the vectors they populate must all have the same dimension in order to be used as inputs for a neural network. +Since there will be very short and very long reviews, we have to decide on the maximum review length that will also correspond to the maximum vector dimensions. I'm going to devise a statistical justification for the max length. Consider the distribution of review lengths:</span></p></h2><div><h2><span style="font-family: inherit;"><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><span style="color: grey;">#import basic statistics</span>
<span style="color: #000084; font-weight: bold;">from</span> statistics <span style="color: #000084; font-weight: bold;">import</span> median, mean
<span style="color: grey;">#initialize list of sequence lengths</span>
lengths = []
<span style="color: grey;">#loop through reviews, counting words and storing the counts</span>
<span style="color: #000084; font-weight: bold;">for</span> review <span style="color: #000084; font-weight: bold;">in</span> df.reviewText:
    length = <span style="color: #000084; font-weight: bold;">len</span>(review.strip().split(<span style="color: blue;">" "</span>))
    lengths.append(length)
<span style="color: grey;">#average review length</span>
meanlen = mean(lengths)
<span style="color: #000084; font-weight: bold;">print</span>(<span style="color: blue;">'The average review is'</span>, <span style="color: #000084; font-weight: bold;">round</span>(meanlen), <span style="color: blue;">'words.'</span>)
<span style="color: grey;">#median review length</span>
medlen = median(lengths)
<span style="color: #000084; font-weight: bold;">print</span>(<span style="color: blue;">'The median review length is'</span>, medlen,<span style="color: blue;">'words.'</span>)</pre></div></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;">The average review is 67 words.
The median review length is 21 words.</pre></span></h2></div><h2 style="text-align: left;"><span style="font-family: inherit;"><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><span style="color: grey;">#histogram of review length</span>
pd.Series(lengths).hist(bins=100,<span style="color: #000084; font-weight: bold;">range</span>=[0,1000])
plt.title(<span style="color: blue;">'Review Lengths Histogram'</span>)
plt.xlabel(<span style="color: blue;">'Length'</span>)
plt.ylabel(<span style="color: blue;">'Frequency'</span>)
plt.show()</pre></div></pre><span class="mjx-chtml MathJax_CHTML" color="rgba(0, 0, 0, 0.87)" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" face="-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;" id="MathJax-Element-5-Frame" role="presentation" style="border: 0px; box-sizing: unset; caret-color: rgba(0, 0, 0, 0.87); direction: ltr; display: inline-block; float: none; font-size: 16.66px; line-height: 0; margin: 0px; max-height: none; max-width: none; min-height: 0px; min-width: 0px; overflow-wrap: normal; padding: 1px 0px; position: relative; print-color-adjust: exact; white-space: nowrap;" tabindex="0"></span></span></h2><h2 style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj65v-eIjnPFVEPJHJWsfQgXYA7g6LEWbYT_K8cnDbsLqYYmwJbaJ25jnSfneA7RwCI0fL087miKZMxKX2pQ13sRHijluqiTQMBiMxUsSWGALhK5AhadirFhviW_b0oeD6I6Q83JPd1_WVHPEDYNszZ8wDmNM28Pcesq9gdkHd_mckoy8h0Atctgk3s/s597/Unknown.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="455" data-original-width="597" height="488" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj65v-eIjnPFVEPJHJWsfQgXYA7g6LEWbYT_K8cnDbsLqYYmwJbaJ25jnSfneA7RwCI0fL087miKZMxKX2pQ13sRHijluqiTQMBiMxUsSWGALhK5AhadirFhviW_b0oeD6I6Q83JPd1_WVHPEDYNszZ8wDmNM28Pcesq9gdkHd_mckoy8h0Atctgk3s/w640-h488/Unknown.png" width="640" /></a></div></h2><h2><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#length quantiles</span>
np.set_printoptions(suppress=True)
np.quantile(lengths,[0,0.25,0.5,0.75,1])</pre></pre></div></pre><span class="mjx-chtml MathJax_CHTML" color="rgba(0, 0, 0, 0.87)" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" face="-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;" id="MathJax-Element-5-Frame" role="presentation" style="border: 0px; box-sizing: unset; caret-color: rgba(0, 0, 0, 0.87); direction: ltr; display: inline-block; float: none; font-size: 16.66px; line-height: 0; margin: 0px; max-height: none; max-width: none; min-height: 0px; min-width: 0px; overflow-wrap: normal; padding: 1px 0px; position: relative; print-color-adjust: exact; white-space: nowrap;" tabindex="0"></span></span><span style="font-size: 14px; font-weight: 400; white-space: pre-wrap;"><span style="font-family: courier;">array([   1.,    6.,   20.,   65., 3232.])</span></span></h2><p style="text-align: left;">It's clear that reviews less than 100 words in length are dominant, and specifically the lengths of 65 words represent the third quar<span style="font-family: inherit;">tile.&nbsp;<span style="background-color: white;"><span color="rgba(0, 0, 0, 0.87)" style="caret-color: rgba(0, 0, 0, 0.87);">Let's remove longer reviews from the&nbsp;analysis. We will make the decision to keep small review lengths, because they tend to contain single-word sentiments that will be relatively simple for the model to pick up and learn. This is the final paring-down of the raw data set and the following code will report the final number of reviews.</span></span></span></p><div><h2><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#fix maximum length</span>
maxlen = 65
<span style="color: grey;">#subset raw reviews for maximum length</span>
reduced_lengths = <span style="color: #000084; font-weight: bold;">list</span>(np.where(np.array(lengths) &lt;= maxlen)[0])
rev_in = [df.reviewText[i] <span style="color: #000084; font-weight: bold;">for</span> i <span style="color: #000084; font-weight: bold;">in</span> reduced_lengths]
<span style="color: grey;">#create vector of sentiment labels</span>
labels = [df[<span style="color: blue;">'overall'</span>][i] <span style="color: #000084; font-weight: bold;">for</span> i <span style="color: #000084; font-weight: bold;">in</span> reduced_lengths]
<span style="color: grey;">#concatenate into dataframe</span>
DF = pd.DataFrame(<span style="color: #000084; font-weight: bold;">list</span>(<span style="color: #000084; font-weight: bold;">zip</span>(rev_in, labels)),
               columns =[<span style="color: blue;">'review_text'</span>, <span style="color: blue;">'sentiment'</span>])
<span style="color: grey;">#verify final number of reviews</span>
rev_tot = <span style="color: #000084; font-weight: bold;">len</span>(DF)
<span style="color: #000084; font-weight: bold;">print</span>(<span style="color: blue;">"There are a total of"</span>,rev_tot,<span style="color: blue;">'reviews under study.'</span>)</pre></pre></div></pre><span class="mjx-chtml MathJax_CHTML" color="rgba(0, 0, 0, 0.87)" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" face="-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;" id="MathJax-Element-5-Frame" role="presentation" style="border: 0px; box-sizing: unset; caret-color: rgba(0, 0, 0, 0.87); direction: ltr; display: inline-block; float: none; font-size: 16.66px; line-height: 0; margin: 0px; max-height: none; max-width: none; min-height: 0px; min-width: 0px; overflow-wrap: normal; padding: 1px 0px; position: relative; print-color-adjust: exact; white-space: nowrap;" tabindex="0"></span></span><span style="font-family: courier; font-size: 14px; font-weight: 400; white-space: pre-wrap;">There are a total of 336419 reviews under study.</span></h2></div><p style="text-align: left;"><span style="font-family: inherit;">This has been a pretty long preprocessing sequence- I'd say we're over half way done! Now that the length of reviews has been set we're going to tokenize the texts with Keras. This is basically the penultimate NLP processing step- the here the individual words in each review are considered the units that contain semantic meaning. This step splits the reviews into their tokens, which creates a structured index of vocabulary that an ML algorithm can model on. Here goes!</span></p><p style="text-align: left;"><span style="font-family: inherit;"></span></p><h2><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#initialize tokenization </span>
tokenizer = Tokenizer()
<span style="color: grey;">#tokenize and build vocabulary set</span>
tokenizer.fit_on_texts(rev_in)
<span style="color: grey;">#find dictionary length</span>
vocab_len = <span style="color: #000084; font-weight: bold;">len</span>(tokenizer.word_index)
<span style="color: #000084; font-weight: bold;">print</span>(<span style="color: blue;">'The final vocabulary size is'</span>, vocab_len, <span style="color: blue;">'words.'</span>)</pre></pre></div></pre><span class="mjx-chtml MathJax_CHTML" color="rgba(0, 0, 0, 0.87)" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" face="-apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;" id="MathJax-Element-5-Frame" role="presentation" style="border: 0px; box-sizing: unset; caret-color: rgba(0, 0, 0, 0.87); direction: ltr; display: inline-block; float: none; font-size: 16.66px; line-height: 0; margin: 0px; max-height: none; max-width: none; min-height: 0px; min-width: 0px; overflow-wrap: normal; padding: 1px 0px; position: relative; print-color-adjust: exact; white-space: nowrap;" tabindex="0"></span></span><span style="font-size: 14px; font-weight: normal; white-space: pre-wrap;"><span style="font-family: courier;">The final vocabulary size is 66776 words.</span></span></h2><p style="text-align: left;">There you have it: 66,776 unique words in the whole body of 336,419. It's a pretty small vocabulary, but it's fair to conclude that this context is pretty restrictive concerning what you can expect people to say. Now that a vocabulary index is established, I want to assign a sequence of indexes to each review and compare the output to the original text.</p><h2><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#create word-index sequences</span>
seq = tokenizer.texts_to_sequences(DF.review_text)
<span style="color: grey;">#sample the first review vector</span>
seq[0]</pre></pre></div></pre></span></h2><div><span style="font-family: inherit;"><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;">[1, 99, 70, 14, 1404, 1126, 2]</pre></span></div><div><span><h2 style="font-family: inherit;"><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#examine standardized review index 0</span>
DF.review_text[0]</pre></pre></div></pre></span></h2><div><span style="font-family: courier;"><div style="text-align: left;"><span style="font-size: 14px; white-space: pre-wrap;">'game bit hard get hang of great '</span></div></span></div></span></div><div><span style="font-family: inherit;"><br /></span></div><div><span style="font-family: inherit;">Right there we get an interesting sense of the most common words. As expected, the sequence&nbsp;</span><span style="white-space: pre-wrap;">[1, 99, 70, 14, 1404, 1126, 2] when compared to its source indicates that 'game' is the number one most frequent word in the dataset. </span></div><div><span style="font-family: inherit;"><br /></span></div><div><span style="font-family: inherit;">You'll recall how we set the maximum allowable review length to 65? It's name to apply the real reasoning for that by placing sequences like this one into vectors that all have the same length- where there are no word indexes to apply for reviews that are too short, we pad the sequence with zeros. Appropriately, the process is called sequence padding and Keras has a function just for this purpose.</span></div><div><span style="font-family: inherit;"><h2 style="font-family: inherit;"><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#pad out word sequences length 65</span>
pad = pad_sequences(seq, padding=<span style="color: blue;">'post'</span>, maxlen=maxlen)
<span style="color: grey;">#compare output</span>
pad[0]</pre></pre></div></pre></span></h2><div><span style="font-family: courier;"></span></div></span></div><h2 style="text-align: left;"><span style="font-family: inherit;"><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;">array([   1,   99,   70,   14, 1404, 1126,    2,    0,    0,    0,    0,
          0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
          0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
          0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
          0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
          0,    0,    0,    0,    0,    0,    0,    0,    0,    0],
      dtype=int32)</pre></span></h2><div style="text-align: left;"><span style="font-family: inherit;">Hopefully what we have been up to thus far is now a little more clear. I'm going to wrap up this section on preprocessing by preparing the train/test split at a 0.1 proportion:</span></div><div style="text-align: left;"><span style="font-family: inherit;"><div><span style="font-family: inherit;"><h2 style="font-family: inherit;"><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#import train/test split function</span>
<span style="color: #000084; font-weight: bold;">from</span> sklearn.model_selection <span style="color: #000084; font-weight: bold;">import</span> train_test_split
<span style="color: grey;">#retrieve explainers and targets</span>
X = pad
y = DF.sentiment
<span style="color: grey;">#call split function at 0.1 test size, set random seed</span>
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.10, random_state= 43022)</pre></pre></div></pre></span></h2><div><span style="font-family: courier;"></span></div></span></div><h2><span></span></h2></span></div><h2 style="text-align: left;"><span style="font-family: inherit;">Model Building</span></h2><div style="text-align: left;"><span style="color: #6aa84f; font-family: inherit; font-weight: normal;">Thanks for reading this far! The writeup for this and the remaining sections is on the way! For now, I'll provide the code.</span></div><div style="text-align: left;"><span style="color: #6aa84f; font-family: inherit; font-weight: normal;"><div style="caret-color: rgb(0, 0, 0); color: black;"><span style="font-family: inherit;"><div><span style="font-family: inherit;"><h2 style="font-family: inherit;"><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#initialize embedding dictionary</span>
embeddings_dictionary = <span style="color: #000084; font-weight: bold;">dict</span>()
<span style="color: grey;">#access GloVe matrix</span>
glove_file = <span style="color: #000084; font-weight: bold;">open</span>(<span style="color: blue;">'/Volumes/EXT128/WGU/Advanced Analytics/nlp/glove/glove.6B.100d.txt'</span>, encoding=<span style="color: blue;">"utf8"</span>)

<span style="color: grey;">#loop through GloVe database vocabulary</span>
<span style="color: #000084; font-weight: bold;">for</span> line <span style="color: #000084; font-weight: bold;">in</span> glove_file:
    <span style="color: grey;">#split line and into tokens</span>
    records = line.split()
    <span style="color: grey;">#capture word entry</span>
    word = records[0]
    <span style="color: grey;">#capture the 100 word scores as an array</span>
    vector_dimensions = asarray(records[1:], dtype=<span style="color: blue;">'float32'</span>)
    <span style="color: grey;">#create dictionary entry with word:score pairs</span>
    embeddings_dictionary [word] = vector_dimensions
<span style="color: grey;">#close file connection after loop completion</span>
glove_file.close()

<span style="color: grey;">#initialize a matrix with the size of our vocabulary and 100 columns</span>
embedding_matrix = zeros((vocab_len + 1, 100))
<span style="color: grey;">#loop through tokens</span>
<span style="color: #000084; font-weight: bold;">for</span> word, index <span style="color: #000084; font-weight: bold;">in</span> tokenizer.word_index.items():
    <span style="color: grey;">#find each word in the vocabulary</span>
    embedding_vector = embeddings_dictionary.get(word)
    <span style="color: grey;">#check to see if vocabulary space has scores </span>
    <span style="color: #000084; font-weight: bold;">if</span> embedding_vector <span style="color: #000084; font-weight: bold;">is</span> <span style="color: #000084; font-weight: bold;">not</span> None:
        <span style="color: grey;">#assign scores to words in the project vocabulary</span>
        embedding_matrix[index] = embedding_vector</pre></pre></div></pre></span></h2><div><span style="font-family: courier;"></span></div></span></div><h2><span></span></h2></span></div></span></div><h2 style="text-align: left;"><span style="font-family: inherit;"><div style="font-weight: 400;"><span style="font-family: inherit;"><div><span style="font-family: inherit;"><span style="font-family: courier;"></span></span></div><h2><span></span></h2></span></div></span></h2><h2 style="font-family: inherit;"><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#initialize sequential model</span>
model = Sequential()
<span style="color: grey;">#create embedding layer with the vocabulary size, embedding dimension, and input length</span>
embedding_layer = Embedding(vocab_len + 1, 100, weights=[embedding_matrix], input_length=maxlen , trainable=False)
<span style="color: grey;">#implement embedding layer</span>
model.add(embedding_layer)
<span style="color: grey;">#add LSTM layer with 128 neurons</span>
model.add(LSTM(128,dropout = 0.5))
<span style="color: grey;">#add final classification layer</span>
model.add(Dense(1, activation=<span style="color: blue;">'sigmoid'</span>))

<span style="color: grey;">#compile model</span>
model.<span style="color: #000084; font-weight: bold;">compile</span>(optimizer=<span style="color: blue;">'adam'</span>, loss=<span style="color: blue;">'binary_crossentropy'</span>, metrics=[<span style="color: blue;">'acc'</span>])

<span style="color: grey;">#summarize model</span>
<span style="color: #000084; font-weight: bold;">print</span>(model.summary())</pre></pre></div></pre></span></h2><h2 style="text-align: left;"><span style="font-family: inherit;"><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;">Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 embedding (Embedding)       (None, 65, 100)           6677700   
                                                                 
 lstm (LSTM)                 (None, 128)               117248    
                                                                 
 dense (Dense)               (None, 1)                 129       
                                                                 
=================================================================
Total params: 6,795,077
Trainable params: 117,377
Non-trainable params: 6,677,700
_________________________________________________________________
None</pre></span></h2><h2 style="text-align: left;"><span style="font-family: inherit;"><h2 style="text-align: left;"><span style="-webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; caret-color: rgb(0, 0, 0); color: black; font-family: inherit; font-size: 24px; font-style: normal; font-variant-caps: normal; font-weight: 700; letter-spacing: normal; orphans: auto; text-align: left; text-decoration: none; text-indent: 0px; text-size-adjust: auto; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px;"></span></h2></span></h2><h2 style="font-family: inherit;"><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#import early stopping module</span>
<span style="color: #000084; font-weight: bold;">from</span> keras.callbacks <span style="color: #000084; font-weight: bold;">import</span> EarlyStopping
<span style="color: grey;">#add early stop for successive increases in validation loss across epochs</span>
es = EarlyStopping(monitor=<span style="color: blue;">"val_loss"</span>,verbose=2,mode=<span style="color: blue;">'min'</span>,patience=2)
<span style="color: grey;">#fit model with a maximum 20 epochs and early stopping criteria</span>
history = model.fit(X_train, y_train, batch_size=128, epochs=20, verbose=1, validation</pre></pre></div></pre></span></h2><h2 style="text-align: left;"><span style="font-family: inherit;"><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;">Epoch 1/20</pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 258s 135ms/step - loss: 0.2429 - acc: 0.9072 - val_loss: 0.1846 - val_acc: 0.9310</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 2/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 268s 142ms/step - loss: 0.1920 - acc: 0.9256 - val_loss: 0.1706 - val_acc: 0.9356</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 3/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 270s 142ms/step - loss: 0.1775 - acc: 0.9316 - val_loss: 0.1810 - val_acc: 0.9405</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 4/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 268s 142ms/step - loss: 0.1679 - acc: 0.9353 - val_loss: 0.1424 - val_acc: 0.9474</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 5/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 279s 147ms/step - loss: 0.1608 - acc: 0.9382 - val_loss: 0.1521 - val_acc: 0.9481</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 6/20</span><span style="font-family: inherit;">1893/1893 [==============================] - 263s 139ms/step - loss: 0.1559 - acc: 0.9402 - val_loss: 0.1398 - val_acc: 0.9488</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 7/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 263s 139ms/step - loss: 0.1516 - acc: 0.9419 - val_loss: 0.1319 - val_acc: 0.9509</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 8/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 261s 138ms/step - loss: 0.1480 - acc: 0.9431 - val_loss: 0.1298 - val_acc: 0.9505</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 9/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 270s 142ms/step - loss: 0.1447 - acc: 0.9444 - val_loss: 0.1273 - val_acc: 0.9524</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 10/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 274s 145ms/step - loss: 0.1420 - acc: 0.9462 - val_loss: 0.1277 - val_acc: 0.9522</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 11/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 264s 139ms/step - loss: 0.1397 - acc: 0.9467 - val_loss: 0.1249 - val_acc: 0.9536</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 12/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 262s 138ms/step - loss: 0.1366 - acc: 0.9476 - val_loss: 0.1252 - val_acc: 0.9533</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 13/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 263s 139ms/step - loss: 0.1356 - acc: 0.9475 - val_loss: 0.1228 - val_acc: 0.9533</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 14/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 226s 120ms/step - loss: 0.1333 - acc: 0.9490 - val_loss: 0.1221 - val_acc: 0.9541</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 15/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 161s 85ms/step - loss: 0.1332 - acc: 0.9493 - val_loss: 0.1234 - val_acc: 0.9550</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 16/20</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">1893/1893 [==============================] - 150s 79ms/step - loss: 0.1321 - acc: 0.9496 - val_loss: 0.1280 - val_acc: 0.9548</span></pre><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;"><span style="font-family: inherit;">Epoch 16: early stopping</span></pre><h3 style="text-align: left;"><span style="font-family: inherit;">Model Validation</span></h3></span></h2><h2 style="font-family: inherit;"><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#plot loss for training and validation</span>
plt.plot(history.history[<span style="color: blue;">'loss'</span>])
plt.plot(history.history[<span style="color: blue;">'val_loss'</span>])
plt.title(<span style="color: blue;">'Train and Validation Model Loss over Epochs'</span>)
plt.ylabel(<span style="color: blue;">'loss'</span>)
plt.xlabel(<span style="color: blue;">'epoch'</span>)
plt.legend([<span style="color: blue;">'train'</span>,<span style="color: blue;">'validation'</span>], loc=<span style="color: blue;">'upper left'</span>)
plt.show()
<span style="color: grey;">#plot accuracy for loss and validation</span>
plt.plot(history.history[<span style="color: blue;">'acc'</span>])
plt.plot(history.history[<span style="color: blue;">'val_acc'</span>])
plt.title(<span style="color: blue;">'Train and Validation Model Accuracy over Epochs'</span>)
plt.ylabel(<span style="color: blue;">'accuracy'</span>)
plt.xlabel(<span style="color: blue;">'epoch'</span>)
plt.legend([<span style="color: blue;">'train'</span>,<span style="color: blue;">'validation'</span>], loc=<span style="color: blue;">'upper left'</span>)
plt.show()</pre></pre></div></pre></span></h2><h2 style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNB9f2ybAsmmEfM915JMK0IMeHVa0dZe9nKs3sMBURpeRNCtwM5i2LD1ch3aRozNvhmDDlGIYcmMbIK4x87aV66_dMXepMnbaCp2kbbrbSbHj2t8anc7skJD0Im3VjCfEkTxiMRjYlaWWE_SLbWtel3QYRbFHbf5tJ-yPR4zJJh4HY-1J14tO1mNUI/s590/Screen%20Shot%202022-11-20%20at%2011.09.08%20AM.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="448" data-original-width="590" height="486" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNB9f2ybAsmmEfM915JMK0IMeHVa0dZe9nKs3sMBURpeRNCtwM5i2LD1ch3aRozNvhmDDlGIYcmMbIK4x87aV66_dMXepMnbaCp2kbbrbSbHj2t8anc7skJD0Im3VjCfEkTxiMRjYlaWWE_SLbWtel3QYRbFHbf5tJ-yPR4zJJh4HY-1J14tO1mNUI/w640-h486/Screen%20Shot%202022-11-20%20at%2011.09.08%20AM.png" width="640" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHtuABx3NkpaOnZHAouc4krbcVrvfYKA6JwWA8yJVZ2CkUJCC8f98EBUipSImJTGmzpDkisCbAYrHBOV3afCgZ4vzbLDb1K4VKvsQUUq3guVPx6_cc9NdI5ZQgQLzMNH8HGy7uQRt-1Z5JsEfAU6NSXPCOTxij4CxrExL0_0b4-HS1i39e81TA2Eln/s589/Screen%20Shot%202022-11-20%20at%2011.09.17%20AM.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="453" data-original-width="589" height="492" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHtuABx3NkpaOnZHAouc4krbcVrvfYKA6JwWA8yJVZ2CkUJCC8f98EBUipSImJTGmzpDkisCbAYrHBOV3afCgZ4vzbLDb1K4VKvsQUUq3guVPx6_cc9NdI5ZQgQLzMNH8HGy7uQRt-1Z5JsEfAU6NSXPCOTxij4CxrExL0_0b4-HS1i39e81TA2Eln/w640-h492/Screen%20Shot%202022-11-20%20at%2011.09.17%20AM.png" width="640" /></a></div><span style="font-family: inherit;"><h2 style="text-align: left;"></h2></span></h2><h2 style="font-family: inherit;"><span><pre class="r" style="background-color: whitesmoke; border-radius: 4px; border: 1px solid rgb(204, 204, 204); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 13px; line-height: 1.42857; margin-bottom: 10px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 9.5px; word-break: break-all;"><div style="caret-color: rgb(0, 0, 0); color: black; white-space: normal;"><pre style="background-color: white; font-weight: 400;"><pre><span style="color: grey;">#import confusion plotting module</span>
<span style="color: #000084; font-weight: bold;">from</span> sklearn <span style="color: #000084; font-weight: bold;">import</span> metrics
<span style="color: grey;">#create prediction and truth vectors</span>
y_pred = model.predict(X_test)
y_pred = np.where(y_pred &gt; 0.5, 1,0)
y_true = y_test
<span style="color: grey;">#create confusion matrix and visualization</span>
confusion_matrix = metrics.confusion_matrix(y_true, y_pred)
cm_display = metrics.ConfusionMatrixDisplay(confusion_matrix = confusion_matrix, display_labels = [<span style="color: blue;">'Unfavorable'</span>, <span style="color: blue;">'Favorable'</span>])
<span style="color: grey;">#plot matrix</span>
cm_display.plot(colorbar=False,cmap = <span style="color: blue;">'PuBuGn'</span>)
plt.show()
<span style="color: grey;">#create binary classification metrics</span>
Accuracy = metrics.accuracy_score(y_true, y_pred)
Precision = metrics.precision_score(y_true, y_pred)
Sensitivity_recall = metrics.recall_score(y_true, y_pred)
Specificity = metrics.recall_score(y_true, y_pred, pos_label=0)
F1Score = metrics.f1_score(y_true, y_pred)
<span style="color: grey;">#disply all binary classification metrics</span>
<span style="color: #000084; font-weight: bold;">print</span>(<span style="color: blue;">"--- Test Set Metrics ---"</span>)
<span style="color: #000084; font-weight: bold;">print</span>(<span style="color: blue;">"Accuracy:"</span>, Accuracy)
<span style="color: #000084; font-weight: bold;">print</span>(<span style="color: blue;">"Precision:"</span>, Precision)
<span style="color: #000084; font-weight: bold;">print</span>(<span style="color: blue;">"Sensitivity:"</span>, Sensitivity_recall)
<span style="color: #000084; font-weight: bold;">print</span>(<span style="color: blue;">"Specificity:"</span>, Specificity)
<span style="color: #000084; font-weight: bold;">print</span>(<span style="color: blue;">"F1 Score:"</span>, F1Score)</pre></pre></div></pre></span></h2><h2 style="text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg0KLMZzmvTYbyia4rE9a_l0nDcOXVBrKeMfcvP9KK6SAAKeKHv7tA2XWM7R0uXxLn12I8YgKytk5kTv5t2-rwko9k5bQwPjQ54Hn49IaWLL0NxUrSRGL1-5iG7va7JDmE_5h6TUOkglSCkYW87p1aN5o3KHltbQmrnB7zPjDdnxENU2l3T0PSDvvSf/s516/Screen%20Shot%202022-11-20%20at%2011.10.56%20AM.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="434" data-original-width="516" height="538" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg0KLMZzmvTYbyia4rE9a_l0nDcOXVBrKeMfcvP9KK6SAAKeKHv7tA2XWM7R0uXxLn12I8YgKytk5kTv5t2-rwko9k5bQwPjQ54Hn49IaWLL0NxUrSRGL1-5iG7va7JDmE_5h6TUOkglSCkYW87p1aN5o3KHltbQmrnB7zPjDdnxENU2l3T0PSDvvSf/w640-h538/Screen%20Shot%202022-11-20%20at%2011.10.56%20AM.png" width="640" /></a></div><pre style="border-radius: 0px; border: 0px; box-sizing: border-box; font-size: 14px; font-weight: 400; line-height: inherit; margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; overflow: auto; padding: 1px 0px; vertical-align: baseline; white-space: pre-wrap; word-break: break-all;">--- Test Set Metrics ---
Accuracy: 0.9560073717377088
Precision: 0.964507225198896
Sensitivity: 0.9871381568014889
Specificity: 0.6923726428370391
F1 Score: 0.9756914788778661</pre></h2><h2 style="text-align: left;"><span style="font-family: inherit;">References</span></h2><p style="text-align: left;"><span style="font-family: inherit;"><span face="arial, sans-serif" style="background-color: white; caret-color: rgb(32, 33, 36); color: #202124; font-size: 16px;">¹</span><span color="rgba(0, 0, 0, 0.87)" style="background-color: white; caret-color: rgba(0, 0, 0, 0.87);">Srivastava, P. Essentials of Deep Learning : Introduction to Long Short Term Memory. Analytics Vidhya. 05/2020. <a href="https://www.analyticsvidhya.com/blog/2017/12/fundamentals-of-deep-learning-introduction-to-lstm/">https://www.analyticsvidhya.com/blog/2017/12/fundamentals-of-deep-learning-introduction-to-lstm/</a></span></span></p><p style="text-align: left;"><span style="font-family: inherit;"><span face="arial, sans-serif" style="background-color: white; caret-color: rgb(32, 33, 36); color: #202124; font-size: 16px;">²</span><span color="rgba(0, 0, 0, 0.87)" style="background-color: white; caret-color: rgba(0, 0, 0, 0.87);">Pennington, J. et al. GloVe: Global Vectors for Word Representation. Stanford. 08/2014. <a href="https://nlp.stanford.edu/projects/glove/">https://nlp.stanford.edu/projects/glove/</a></span></span></p><p style="text-align: left;"><span style="font-family: inherit;"><span color="rgba(0, 0, 0, 0.87)" style="background-color: white; caret-color: rgba(0, 0, 0, 0.87);"><span face="arial, sans-serif" style="caret-color: rgb(32, 33, 36); color: #202124; font-size: 16px;">³</span>McAuley, J. Amazon Product Data. UCSD. 05/2021. <a href="https://nijianmo.github.io/amazon/index.html">https://nijianmo.github.io/amazon/index.html</a></span></span></p><div style="text-align: left;"><span style="font-family: inherit;"><span class="mjx-chtml MathJax_CHTML" color="rgba(0, 0, 0, 0.87)" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" id="MathJax-Element-5-Frame" role="presentation" style="border: 0px; box-sizing: unset; caret-color: rgba(0, 0, 0, 0.87); direction: ltr; display: inline-block; float: none; line-height: 0; margin: 0px; max-height: none; max-width: none; min-height: 0px; min-width: 0px; overflow-wrap: normal; padding: 1px 0px; position: relative; print-color-adjust: exact; white-space: nowrap;" tabindex="0"><span class="MJX_Assistive_MathML" role="presentation" style="-webkit-user-select: none; border: 0px; box-sizing: unset; clip: rect(1px, 1px, 1px, 1px); display: block; height: 1px; left: 0px; overflow: hidden; padding: 1px 0px 0px; position: absolute; print-color-adjust: exact; top: 0px; user-select: none; width: 1px;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi></msup></math></span></span></span></div><div style="text-align: left;"><span style="font-family: inherit;"><span style="background-color: white; caret-color: rgb(33, 37, 41); color: #212529; font-size: 16px;">⁴Dernoncourt, F. The Effect of Stopword Filtering prior to Word Embedding. StackExchange. 01/2016.&nbsp;</span><a href="https://stats.stackexchange.com/questions/201372/the-effect-of-stopword-filtering-prior-to-word-embedding-training">https://stats.stackexchange.com/questions/201372/the-effect-of-stopword-filtering-prior-to-word-embedding-training</a></span></div><div style="text-align: left;"><br /></div><div style="text-align: center;"><br /></div><div style="text-align: center;"><br /></div><div style="text-align: center;"><br /></div><div style="text-align: center;"><br /></div><div style="text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiC8h0AyAqKvR89mB0sWK14qyS_8nacnvcjvkzEKd3znX5xkmnP2llx5EiKgzTM-BfiZ1XrA5Nq6ZqO9ZGkHomo34dXxTR5jtVa9014rqtYjHYrEabJgMIc-PspANJkrb5F_vZSH0120C7ki2haqx399BGga4hdA5huyC3wHjBDgVmeXH4UmXNNLauy/s487/Untitled.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="373" data-original-width="487" height="245" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiC8h0AyAqKvR89mB0sWK14qyS_8nacnvcjvkzEKd3znX5xkmnP2llx5EiKgzTM-BfiZ1XrA5Nq6ZqO9ZGkHomo34dXxTR5jtVa9014rqtYjHYrEabJgMIc-PspANJkrb5F_vZSH0120C7ki2haqx399BGga4hdA5huyC3wHjBDgVmeXH4UmXNNLauy/s320/Untitled.png" width="320" /></a></div><br />
</body>

  <script>
    // Inject nav.html into #navbar
    fetch("/partials/nav.html")
      .then(response => response.text())
      .then(html => {
        document.getElementById("navbar").innerHTML = html;
      });
  </script>






